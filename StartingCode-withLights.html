<html>
<head>
	<title>Starting Code for 1st Project 2017 - with lights and textures</title>
	<style>

	body {
		font-family: Monospace;
		background-color: #f0f0f0;
		margin: 0px;
		overflow: hidden;
	}

	canvas {
		width: 100%;
		height: 100%;
	}

	</style>
	<script src="lib/three.min.js"></script>
	<script src="lib/stats.min.js"></script>
	<script src="lib/Coordinates.js"></script>
	<script src="lib/OrbitControls.js"></script>
	<script src="lib/dat.gui/build/dat.gui.min.js"></script>
	<script src="guiController/gui.js"></script>
	<script src="loaders/loadGarage.js"></script>
	<script src="loaders/loadSalotto.js"></script>
	<script src="loaders/loadBagno.js"></script>

</head>
<body>

	<script>

	var gui = new dat.GUI();

	var scene, camera, renderer, controls, stats, pointlight;
	//object per l'animazione e interazione
	var portoneGarage, luciCasa;
	cucina = "models/cucina sala da pranzo.json";
	bagno = "models/bagno e camera.json";


	function Start() {

		createGUI();

		scene = new THREE.Scene();
		camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

		renderer = new THREE.WebGLRenderer( {antialias: true} );
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.setClearColor( 0xf0f0f0 );
		renderer.setPixelRatio( window.devicePixelRatio );
		renderer.gammaInput = true;
		renderer.gammaOutput = true;
		renderer.shadowMap.enabled = true;
		document.body.appendChild( renderer.domElement );

		camera.position.set(-6,2,3);
		camera.lookAt(new THREE.Vector3(0, 0, 0));

		initLuci();

		//loader
		makeGarage();
		makeBagno();
		makeSalotto();

		// GROUND
		var groundGeo = new THREE.PlaneBufferGeometry( 10000, 10000 );
		var groundMat = new THREE.MeshBasicMaterial( { color: 0x404040} );
		var ground = new THREE.Mesh( groundGeo, groundMat );
		ground.position.y = 0;
		ground.rotation.x = -Math.PI/2;
		ground.receiveShadow = true;
		scene.add( ground );

		stats = new Stats();
		stats.domElement.style.position = 'absolute';
		stats.domElement.style.top = '0px';
		document.body.appendChild( stats.domElement );

		// uncomment if you need to draw coordinate axes when building the scene
		//Coordinates.drawAllAxes();

		controls = new THREE.OrbitControls( camera );
		controls.addEventListener( 'change', Render );


	}

	function Update() {
		requestAnimationFrame( Update );
		controls.update();
		stats.update();
		Render();
	}

	function makeGarage(){  //crea gli oggetti dinamici e carica quelli statici
		portoneGarage = new THREE.Object3D();

		portoneGeom = new THREE.BoxBufferGeometry(2.5, 2.0, 0.2);
		portoneMat = new THREE.MeshPhongMaterial({color: 0x5f2a32});
		portone = new THREE.Mesh(portoneGeom, portoneMat);
		portone.castShadow = true;
		portone.receiveShadow = true;

		manigliaGeom = new THREE.BoxBufferGeometry(0.3, 0.04, 0.3);
		manigliaMat = new THREE.MeshPhongMaterial({color: 0x000000});
		maniglia = new THREE.Mesh(manigliaGeom, manigliaMat);
		maniglia.position.set(0, -0.78, 0);
		maniglia.castShadow = true;
		maniglia.receiveShadow = true;

		portoneGarage.add(portone);
		portoneGarage.add(maniglia);
		portoneGarage.position.set(0, -0.35, 0);

		loadGarage();
	}

	function makeBagno(){

		loadBagno();
	}

	function makeSalotto(){

		loadSalotto();
	}

	function initLuci(){
		luciCasa = new Array();
		for(i = 0; i<9; i++){
			luciCasa[i] = new THREE.PointLight();
			luciCasa[i].castShadow = true;
		}

	}

	function Render() {
		renderer.render(scene, camera);
	}

	Start();
	Update();

	</script>
</body>
</html>
